<DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>MN.gpt - Ù…Ø¯ÙŠØ± Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª</title>
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"  rel="stylesheet" />
</head>
<body class="bg-gray-50 text-gray-800">
  <div id="app" class="max-w-6xl mx-auto px-4 py-8"></div>

  <script>
    // ğŸ”’ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    const userRole = localStorage.getItem('userRole');

    if (!userRole) {
      window.location.href = 'login.html';
    }

    // ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
    let prompts = JSON.parse(localStorage.getItem('prompts')) || [
      { id: 1, text: 'Ø§Ø´Ø±Ø­ Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø³ÙŠØ·Ø©.', category: 'ØªØ¹Ù„ÙŠÙ…ÙŠ', tokens: 23 },
      { id: 2, text: 'Ø§ÙƒØªØ¨ Ù‚ØµØ© Ù‚ØµÙŠØ±Ø© Ø¹Ù† Ø±Ø­Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙØ¶Ø§Ø¡.', category: 'Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ', tokens: 45 },
      { id: 3, text: 'Ù…Ø§ Ù‡Ùˆ ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ØŸ', category: 'ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª', tokens: 18 },
    ];

    let categories = JSON.parse(localStorage.getItem('categories')) || ['Ø¹Ø§Ù…', 'ØªØ¹Ù„ÙŠÙ…ÙŠ', 'Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ', 'ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª'];

    // ğŸ–‹ï¸ HTML Ø¨Ù†Ø§Ø¡
    const app = document.getElementById('app');

    const dashboardHTML = `
      <header class="flex justify-between items-center pb-4 border-b border-gray-200 mb-6">
        <h1 class="text-2xl font-bold text-indigo-700">MN.gpt</h1>
        ${userRole === 'admin' ? `<a href="#" onclick="switchTab('prompts')" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª</a>` : ''}
      </header>

      <div class="mb-8">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª</h3>
            <p class="text-3xl font-bold text-indigo-600">${prompts.length}</p>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙˆÙƒÙŠØ§Ù†Ø§Øª</h3>
            <p class="text-3xl font-bold text-blue-600">${prompts.reduce((sum, p) => sum + p.tokens, 0)}</p>
          </div>
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-lg font-semibold text-gray-700 mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
            <p class="text-3xl font-bold text-green-600">${categories.length}</p>
          </div>
        </div>
      </div>

      <footer class="pt-6 border-t border-gray-200 text-center text-sm text-gray-500 mt-10">
        &copy; ${new Date().getFullYear()} MN.gpt. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
      </footer>
    `;

    const promptsHTML = `
      <header class="flex justify-between items-center pb-4 border-b border-gray-200 mb-6">
        <h1 class="text-2xl font-bold text-indigo-700">MN.gpt</h1>
        <a href="#" onclick="switchTab('dashboard')" class="text-indigo-600 hover:underline">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
      </header>

      <h2 class="text-2xl font-bold text-gray-800 mb-6">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª</h2>

      <form id="promptForm" class="bg-white shadow rounded-lg p-6 mb-8">
        <input type="text" id="promptText" placeholder="Ù…Ø«Ø§Ù„: Ø§Ø´Ø±Ø­ Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ..." class="w-full p-3 border border-gray-300 rounded mb-4 focus:outline-none focus:ring-2 focus:ring-indigo-500" required />
        
        <select id="promptCategory" class="w-full p-3 border border-gray-300 rounded mb-4 focus:outline-none focus:ring-2 focus:ring-indigo-500">
          ${categories.map(cat => `<option value="${cat}">${cat}</option>`).join('')}
          <option disabled>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</option>
          <option value="">+ Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯</option>
        </select>

        <input type="number" id="promptTokens" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ØªÙˆÙƒÙŠØ§Ù†Ø§Øª" class="w-full p-3 border border-gray-300 rounded mb-4 focus:outline-none focus:ring-2 focus:ring-indigo-500" />

        <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700">
          Ø¥Ø¶Ø§ÙØ© Ø¨Ø±ÙˆÙ…Ø¨Øª
        </button>
      </form>

      <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
        <div class="p-4 border-b border-gray-200">
          <h3 class="font-semibold text-lg">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª</h3>
        </div>
        <ul class="divide-y divide-gray-200">
          ${prompts.map(prompt => `
            <li class="p-4 flex justify-between items-center hover:bg-gray-50">
              <span>${prompt.text} â€” <strong>${prompt.category}</strong> (${prompt.tokens} ØªÙˆÙƒÙŠØ§Ù†)</span>
              ${userRole === 'admin' ? `<button onclick="deletePrompt(${prompt.id})" class="text-red-600 hover:text-red-800">Ø­Ø°Ù</button>` : ''}
            </li>
          `).join('')}
          ${prompts.length === 0 ? '<li class="p-4 text-center text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</li>' : ''}
        </ul>
      </div>

      ${userRole === 'admin' ? `
      <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="p-4 border-b border-gray-200">
          <h3 class="font-semibold text-lg">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
        </div>
        <ul class="divide-y divide-gray-200">
          ${categories.map(cat => `
            <li class="p-4 flex justify-between items-center hover:bg-gray-50">
              <span>${cat}</span>
              <div class="space-x-2 space-x-reverse">
                <button onclick="editCategory('${cat}')" class="text-yellow-600">ØªØ¹Ø¯ÙŠÙ„</button>
                <button onclick="deleteCategory('${cat}')" class="text-red-600">Ø­Ø°Ù</button>
              </div>
            </li>
          `).join('')}
        </ul>
      </div>
      ` : ''}

      <footer class="pt-6 border-t border-gray-200 text-center text-sm text-gray-500 mt-10">
        &copy; ${new Date().getFullYear()} MN.gpt. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
      </footer>
    `;

    function switchTab(tab) {
      if (tab === 'dashboard') {
        document.getElementById('app').innerHTML = dashboardHTML;
      } else {
        document.getElementById('app').innerHTML = promptsHTML;
      }
    }

    function deletePrompt(id) {
      prompts = prompts.filter(p => p.id !== id);
      localStorage.setItem('prompts', JSON.stringify(prompts));
      switchTab('prompts');
    }

    function deleteCategory(category) {
      if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù… "' + category + '" ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡ØŸ')) return;
      prompts = prompts.filter(p => p.category !== category);
      categories = categories.filter(c => c !== category);
      localStorage.setItem('prompts', JSON.stringify(prompts));
      localStorage.setItem('categories', JSON.stringify(categories));
      switchTab('prompts');
    }

    function editCategory(oldName) {
      const newName = prompt('Ø¹Ø¯Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…:', oldName);
      if (!newName || !oldName || !categories.includes(oldName)) return;
      prompts = prompts.map(p => (p.category === oldName ? { ...p, category: newName } : p));
      categories = categories.map(c => (c === oldName ? newName : c));
      localStorage.setItem('prompts', JSON.stringify(prompts));
      localStorage.setItem('categories', JSON.stringify(categories));
      switchTab('prompts');
    }

    document.getElementById('promptForm')?.addEventListener('submit', function(e) {
      e.preventDefault();
      const text = document.getElementById('promptText').value.trim();
      const category = document.getElementById('promptCategory').value.trim();
      const tokens = parseInt(document.getElementById('promptTokens').value) || 0;

      if (!text || !category) {
        alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
        return;
      }

      const newPrompt = { id: Date.now(), text, category, tokens };
      prompts.push(newPrompt);
      if (!categories.includes(category)) {
        categories.push(category);
      }

      localStorage.setItem('prompts', JSON.stringify(prompts));
      localStorage.setItem('categories', JSON.stringify(categories));

      switchTab('prompts');
    });

    // ğŸ‘‰ Ø¹Ø±Ø¶ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø£ÙˆÙ„ÙŠ
    const activeTab = location.hash.slice(1) || 'dashboard';
    switchTab(activeTab);
  </script>
</body>
</html>
