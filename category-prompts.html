<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ø§Ù„Ù‚Ø³Ù…</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"  crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"  crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> 
  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"  rel="stylesheet" />
  <!-- Internal Styles -->
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
    }
  </style>
</head>
<body class="min-h-screen bg-gray-50 p-4">
  <header class="mb-6">
    <h1 id="pageTitle" class="text-2xl font-bold text-indigo-700">Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ø§Ù„Ù‚Ø³Ù…</h1>
  </header>
  <div id="root"></div>
  <footer class="mt-8 pt-4 border-t border-gray-200 text-center text-sm text-gray-500">
    &copy; {{new Date().getFullYear()}} Promptica
  </footer>

  <script type="text/babel">
    const { useState, useEffect } = window.React;

    function App() {
      const [prompts, setPrompts] = useState([]);
      const [copiedItems, setCopiedItems] = useState([]);

      useEffect(() => {
        const urlParams = new URLSearchParams(window.location.search);
        const category = decodeURIComponent(urlParams.get('category') || '');
        const sub = decodeURIComponent(urlParams.get('sub') || '');

        let allPrompts = JSON.parse(localStorage.getItem('prompts')) || [];

        if (sub) {
          allPrompts = allPrompts.filter(p => p.category === category && p.subCategory === sub);
        } else {
          allPrompts = allPrompts.filter(p => p.category === category);
        }

        setPrompts(allPrompts);
        document.getElementById('pageTitle').textContent = `Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ø§Ù„Ù‚Ø³Ù…: ${category}${sub ? ` â†’ ${sub}` : ''}`;
      }, []);

      const copyPrompt = (promptText, promptTitle) => {
        navigator.clipboard.writeText(promptText).then(() => {
          const copiedItem = {
            title: promptTitle,
            text: promptText,
            time: new Date().toLocaleString()
          };
          const updatedCopies = [copiedItem, ...copiedItems];
          setCopiedItems(updatedCopies);
          localStorage.setItem('copies', JSON.stringify(updatedCopies));
          alert("âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!");
        });
      };

      const openPopup = () => {
        const copies = JSON.parse(localStorage.getItem('copies')) || [];
        let content = `
          <div style="padding: 1rem; font-family: sans-serif;">
            <h2 style="font-size: 1.2rem; margin-bottom: 1rem;">Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø®</h2>
            ${copies.length > 0 
              ? `<ul>${copies.map(item => `
                  <li style="margin-bottom: 0.5rem; padding: 0.5rem; border-bottom: 1px solid #eee;">
                    <strong>${item.title}</strong><br/>
                    <small>${item.time}</small>
                  </li>`).join('')}</ul>`
              : '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</p>'
            }
          </div>`;
        const win = window.open('', '_blank', 'width=400,height=600');
        win.document.body.innerHTML = content;
      };

      return (
        <div className="space-y-6">
          {/* Ø²Ø± Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® */}
          <div className="flex justify-between items-center">
            <h2 className="text-xl font-semibold text-gray-800">Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ø§Ù„Ù‚Ø³Ù…</h2>
            <button
              onClick={openPopup}
              className="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700"
            >
              ðŸ“‹ Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø®
            </button>
          </div>

          {/* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {prompts.map((prompt, idx) => (
              <div key={idx} className="bg-white p-4 rounded shadow hover:shadow-md transition relative">
                <p className="text-sm text-gray-600">{prompt.category} â†’ {prompt.subCategory || '-'}</p>
                <p className="line-clamp-3 mt-1 text-gray-800">{prompt.text}</p>
                <button
                  onClick={() => copyPrompt(prompt.text, prompt.category)}
                  className="mt-2 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700"
                >
                  âž• Ù†Ø³Ø®
                </button>
              </div>
            ))}
          </div>

          {prompts.length === 0 && (
            <p className="text-center text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….</p>
          )}
        </div>
      );
    }

    const root = window.ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
