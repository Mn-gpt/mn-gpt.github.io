<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>إدارة تخزين localStorage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"  rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9fafb;
      padding: 2rem;
    }
    .storage-view {
      height: 400px;
      overflow-y: auto;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body class="min-h-screen bg-gray-50">
  <h1 class="text-3xl font-bold text-indigo-600 mb-4">إدارة تخزين localStorage</h1>

  <!-- Buttons -->
  <div class="mb-4">
    <button 
      onclick="showStorageData()" 
      class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded transition duration-300"
    >
      📂 عرض البيانات الحالية
    </button>
    <button 
      onclick="clearStorage()" 
      class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded transition duration-300"
    >
      ❌ مسح التخزين
    </button>
    <button 
      onclick="saveChanges()" 
      class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition duration-300"
    >
      💾 حفظ التعديلات
    </button>
  </div>

  <!-- Storage Viewer -->
  <textarea 
    id="storageData" 
    class="w-full h-64 p-3 border border-gray-300 rounded shadow focus:outline-none focus:ring-2 focus:ring-indigo-500"
    placeholder="سيظهر محتوى localStorage هنا..."
    readonly
  ></textarea>

  <!-- Editing Area -->
  <div class="mt-4">
    <h3 class="text-lg font-medium text-gray-800 mb-2">تعديل البيانات (كود JSON):</h3>
    <textarea 
      id="editedData" 
      class="w-full h-64 p-3 border border-gray-300 rounded shadow focus:outline-none focus:ring-2 focus:ring-indigo-500"
      placeholder="أدخل البيانات المُعدّلة هنا..."
    ></textarea>
  </div>

  <script>
    // دالة عرض البيانات
    function showStorageData() {
      const storageData = {};
      const keysToIgnore = ['__debug__', 'sessionStorage']; // تجاهل مفاتيح غير مهمة

      for (const key of Object.keys(localStorage)) {
        if (!keysToIgnore.includes(key)) {
          try {
            storageData[key] = JSON.parse(localStorage.getItem(key));
          } catch (e) {
            storageData[key] = localStorage.getItem(key);
          }
        }
      }

      const displayArea = document.getElementById('storageData');
      displayArea.value = JSON.stringify(storageData, null, 2);
      displayArea.removeAttribute('readonly'); // إزالة التحرير بعد العرض
    }

    // دالة حفظ التعديلات
    function saveChanges() {
      const editedJson = document.getElementById('editedData').value;
      try {
        const newData = JSON.parse(editedJson);
        for (const key in newData) {
          localStorage.setItem(key, JSON.stringify(newData[key]));
        }
        alert('✅ البيانات تم تحديثها!');
      } catch (e) {
        alert('❌ خطأ في تنسيق JSON! الرجاء التأكد من الصياغة الصحيحة.');
      }
    }

    // دالة مسح التخزين
    function clearStorage() {
      if (!confirm('هل أنت متأكد من مسح جميع البيانات؟')) return;
      localStorage.clear();
      alert('تم المسح!');
    }
  </script>
</body>
</html>
